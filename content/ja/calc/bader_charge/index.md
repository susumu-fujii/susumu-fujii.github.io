---
title: '有効電荷を出してみよう'
date: '2024-04-29'
private: true
---

### Bader Population Analysis
さっきの電荷密度分布の可視化で、原子レベルで原子がカチオン、アニオンになるイメージが少しはついたと思います。
原子の周りでどれくらい電子が増えたか減ったかが定量的に分かるので、ちゃんと解析すれば各イオンの有効電荷を求めることが出来ます。

どの領域の電子までを各イオンに属するものとするかは、いろんな考え方がありますが、ここではBaderの方法を使ってみましょう。
この方法では、原子同士の間で電荷密度が最小となる部分を境界として、各原子に属する空間を区別します（言葉にすると分かりにくいので[このページ](https://theory.cm.utexas.edu/henkelman/research/bader/)の図を見てみて下さい）。

このBaderの解析をするには、第一原理計算の条件を少しだけ変える必要があります。
electronic_structure/01_charge_density/bazro3/normalの中の入力ファイルを、electronic_structure/02_bader_chargeの中にコピーして下さい。
その後、INCARを下記のように修正して計算を回して下さい。

```
ADDGRID    = .TRUE. ->
#ADDGRID    = .TRUE.

LAECHG     = .TRUE. #この行を最後に足す
```

詳しくは説明しませんが、こうすると内殻電子の情報をAECCARというファイルに書き込んでくれるので、Baderの解析ができるようになります。
計算が終わったら、以下のコマンドを実行して下さい。

```bash
perl ~/SCRIPT/vtstscripts-964/chgsum.pl AECCAR0 AECCAR2
bader CHGCAR -ref CHGCAR_sum
```

終わったら、\*.datというファイルがいくつか生成されていると思います。
その中のACF.datを開いて下さい。以下のような感じのはずです。

```
    #         X           Y           Z       CHARGE      MIN DIST   ATOMIC VOL
 --------------------------------------------------------------------------------
    1    0.000000    0.000000    0.000000    8.486779     1.528529    22.801517
    2    2.095199    2.095199    2.095199    9.520672     1.047599    10.708017
    3    2.095199    2.095199    0.000000    7.330850     0.982125    13.357163
    4    2.095199    0.000000    2.095199    7.330850     0.982125    13.357163
    5    0.000000    2.095199    2.095199    7.330850     0.982125    13.357163
 --------------------------------------------------------------------------------
    VACUUM CHARGE:               0.0000
    VACUUM VOLUME:               0.0000
    NUMBER OF ELECTRONS:        40.0000
```

POSCARに書いてある原子順に、座標、CHARGE（イオンの周りの電子の数）、MIN DIST（イオン半径みたいな値）、ATOMIC VOL（イオンの体積みたいな値）が書いてあります。
このCHARGEの値を、各イオンの元々の価電子の数から引けば、有効電荷が出せます。
元々の考えている価電子の数（ZVAL）は、POTCARの中に書いてあります。

```
grep ZVAL POTCAR
```

こうすると、POSCARに書かれている元素の順で、考慮している価電子数が分かります。
計算してみると、有効電荷が形式電荷（Ba<sup>2+</sup>、Zr<sup>4+</sup>、O<sup>2-</sup>）と大きく違うのが分かります。
いろんな化合物で計算してみると、意外と有効電荷が同じ元素でも異なるので、面白いです。

<br>

{{% callout note %}}
{{< spoiler text="ちなみに">}}
この記事の中で使ったbaderというプログラムも、[the Hafner Research Group at the University of Vienna](https://theory.cm.utexas.edu/henkelman/code/bader)が作ったものです。
{{< /spoiler >}}
{{% /callout %}}
